---
title: "Advent of Code 2022"
author: "Bailey Sutton"
date: "12/6/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(data.table)
library(rstatix)
library(stringi)

library(readr)
```

```{r Day 1}

#import
day1 <- data.table::fread("~/Desktop/Projects/Stats/Advent of Code 2022/Day1.txt")

#reformat dataframe
day1_groups <- day1 %>%
  group_split(grp = cumsum(rowSums(is.na(.)) == ncol(.)), .keep = FALSE) %>%
  map_at(.at = -1, tail, -1)

day1_groups <- data.frame(t(sapply(day1_groups,c)))

day1_groups_long <- day1_groups %>% pivot_longer(everything())

day1_groups_long$value <- stri_replace_all_fixed(day1_groups_long$value, "c(", "")
day1_groups_long$value <- stri_replace_all_fixed(day1_groups_long$value, ")", "")

#separate cals
day1_labs <- separate_rows(day1_groups_long, value, sep = ", ", convert = TRUE)

#summarize by group
day1_labs_tot <- day1_labs %>%
  group_by(name) %>%
  summarise(total = sum(value))

#pull highest total
day1_labs_tot <- day1_labs_tot[order(day1_labs_tot$total),]
tail(day1_labs_tot, n = 1)

#pull total of highest three
day1_labs_tot %>% 
  tail(n = 3) %>%
  pull(total) %>%
  sum()
```

```{r Day 2}

#import
day2 <- read_table2("~/Desktop/Projects/Stats/Advent of Code 2022/day2.txt", col_names = FALSE)

#replace obs names
day2$X1 <- gsub("A", "Rock", day2$X1)
day2$X1 <- gsub("B", "Paper", day2$X1)
day2$X1 <- gsub("C", "Scissors", day2$X1)

day2$X2 <- gsub("X", "Rock", day2$X2)
day2$X2 <- gsub("Y", "Paper", day2$X2)
day2$X2 <- gsub("Z", "Scissors", day2$X2)

#calculate choice score
day2$choice_score <- as.numeric(ifelse(day2$X2 == 'Rock', '1',
                                       ifelse(day2$X2 == 'Paper', '2', '3')))

#calculate win score
day2$win_score <- as.numeric(ifelse(day2$X1 == 'Rock' & day2$X2 == 'Rock', '3',
                                    ifelse(day2$X1 == 'Scissors' & day2$X2 == 'Rock', '6',
                                           ifelse(day2$X1 == 'Paper' & day2$X2 == 'Paper', '3',
                                                  ifelse(day2$X1 == 'Rock' & day2$X2 == 'Paper', '6',
                                                         ifelse(day2$X1 == 'Scissors' & day2$X2 == 'Scissors', '3',
                                                                ifelse(day2$X1 == 'Paper' & day2$X2 == 'Scissors', '6', '0')))))))

#calculate total score
day2$total_score <- day2$choice_score + day2$win_score

#final total
sum(day2$total_score)

#X2 new
day2$X2_new <- ifelse(day2$X2 == 'Rock', 'Lose',
                      ifelse(day2$X2 == 'Paper', 'Draw', 'Win'))

#calculate new choice
day2$choice_new <- ifelse(day2$X1 == 'Rock' & day2$X2_new == 'Win', 'Paper',
                          ifelse(day2$X1 == 'Rock' & day2$X2_new == 'Draw', 'Rock',
                                 ifelse(day2$X1 == 'Rock' & day2$X2_new == 'Lose', 'Scissors',
                                        ifelse(day2$X1 == 'Paper' & day2$X2_new == 'Win', 'Scissors',
                                               ifelse(day2$X1 == 'Paper' & day2$X2_new == 'Draw', 'Paper',
                                                      ifelse(day2$X1 == 'Paper' & day2$X2_new == 'Lose', 'Rock',
                                                             ifelse(day2$X1 == 'Scissors' & day2$X2_new == 'Win', 'Rock',
                                                                    ifelse(day2$X1 == 'Scissors' & day2$X2_new == 'Draw', 'Scissors', 'Paper'))))))))

#calculate new choice score
day2$choice_score_new <- as.numeric(ifelse(day2$choice_new == 'Rock', '1',
                                           ifelse(day2$choice_new == 'Paper', '2', '3')))

#calculate new win score
day2$win_score_new <- as.numeric(ifelse(day2$X2_new == 'Win', '6',
                                        ifelse(day2$X2_new == 'Draw', '3', '0')))

#calculate new total score
day2$total_score_new <- day2$choice_score_new + day2$win_score_new

#calculate new total
sum(day2$total_score_new)
```

